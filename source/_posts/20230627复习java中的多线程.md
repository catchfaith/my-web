---
title: å¤ä¹ javaä¸­çš„å¤šçº¿ç¨‹
date: 2023-06-27 10:33:05
categories: Java
---

## 1.ä»€ä¹ˆæ˜¯è¿›ç¨‹ï¼Ÿä»€ä¹ˆæ˜¯çº¿ç¨‹ï¼Ÿ
- è¿›ç¨‹ï¼šä¸€ä¸ªåº”ç”¨ç¨‹åºï¼ˆå¥½æ¯”windowsä¸­ä»»åŠ¡ç®¡ç†å™¨ä¸­ä¸€ä¸ªä¸ªè½¯ä»¶ï¼‰
- çº¿ç¨‹ï¼šä¸€ä¸ªè¿›ç¨‹ä¸­çš„æ‰§è¡Œåœºæ™¯/æ‰§è¡Œå•å…ƒ

æ³¨æ„ï¼š ***<font color=red>ä¸€ä¸ªè¿›ç¨‹å¯ä»¥å¯åŠ¨å¤šä¸ªçº¿ç¨‹</font>***

å¯¹äºjavaç¨‹åºæ¥è¯´ï¼Œå½“åœ¨DOSå‘½ä»¤çª—å£ä¸­è¾“å…¥ï¼š
java HelloWorld å›è½¦ä¹‹åã€‚ä¼šå…ˆå¯åŠ¨JVMï¼Œè€ŒJVMå°±æ˜¯ä¸€ä¸ªè¿›ç¨‹ã€‚

JVMå†å¯åŠ¨ä¸€ä¸ªä¸»çº¿ç¨‹è°ƒç”¨mainæ–¹æ³•ï¼ˆmainæ–¹æ³•å°±æ˜¯ä¸»çº¿ç¨‹ï¼‰ã€‚
åŒæ—¶å†å¯åŠ¨ä¸€ä¸ªåƒåœ¾å›æ”¶çº¿ç¨‹è´Ÿè´£çœ‹æŠ¤ï¼Œå›æ”¶åƒåœ¾ã€‚

æœ€èµ·ç ï¼Œç°åœ¨çš„javaç¨‹åºä¸­è‡³å°‘æœ‰ä¸¤ä¸ªçº¿ç¨‹å¹¶å‘ï¼Œä¸€ä¸ªæ˜¯ åƒåœ¾å›æ”¶çº¿ç¨‹ï¼Œä¸€ä¸ªæ˜¯ æ‰§è¡Œmainæ–¹æ³•çš„ä¸»çº¿ç¨‹ã€‚
## 2.è¿›ç¨‹å’Œçº¿ç¨‹æ˜¯ä»€ä¹ˆå…³ç³»ï¼Ÿ
*è¿›ç¨‹ï¼š* å¯ä»¥çœ‹åšæ˜¯ç°å®ç”Ÿæ´»å½“ä¸­çš„å…¬å¸ã€‚

*çº¿ç¨‹ï¼š* å¯ä»¥çœ‹åšæ˜¯å…¬å¸å½“ä¸­çš„æŸä¸ªå‘˜å·¥ã€‚

æ³¨æ„ï¼š
è¿›ç¨‹Aå’Œè¿›ç¨‹Bçš„ å†…å­˜ç‹¬ç«‹ä¸å…±äº«ã€‚

qqæ˜¯ä¸€ä¸ªè¿›ç¨‹
qqéŸ³ä¹æ˜¯ä¸€ä¸ªè¿›ç¨‹
è¿™ä¸¤ä¸ªè¿›ç¨‹æ˜¯ç‹¬ç«‹çš„ï¼Œä¸å…±äº«èµ„æºã€‚

### 2.1 çº¿ç¨‹Aå’Œçº¿ç¨‹Bæ˜¯ä»€ä¹ˆå…³ç³»ï¼Ÿ
åœ¨javaè¯­è¨€ä¸­ï¼š

çº¿ç¨‹Aå’Œçº¿ç¨‹Bï¼Œ**å †å†…å­˜å’Œæ–¹æ³•åŒºå†…å­˜å…±äº«**ã€‚ä½†æ˜¯ æ ˆå†…å­˜ ç‹¬ç«‹ï¼Œä¸€ä¸ªçº¿ç¨‹ä¸€ä¸ªæ ˆã€‚

å‡è®¾å¯åŠ¨10ä¸ªçº¿ç¨‹ï¼Œä¼šæœ‰10ä¸ªæ ˆç©ºé—´ï¼Œæ¯ä¸ªæ ˆå’Œæ¯ä¸ªæ ˆä¹‹é—´ï¼Œäº’ä¸å¹²æ‰°ï¼Œå„è‡ªæ‰§è¡Œå„è‡ªçš„ï¼Œè¿™å°±æ˜¯å¤šçº¿ç¨‹å¹¶å‘ã€‚

ç«è½¦ç«™ï¼Œå¯ä»¥çœ‹åšæ˜¯ä¸€ä¸ªè¿›ç¨‹ã€‚
ç«è½¦ç«™ä¸­çš„æ¯ä¸€ä¸ªå”®ç¥¨çª—å£å¯ä»¥çœ‹åšæ˜¯ä¸€ä¸ªçº¿ç¨‹ã€‚
æˆ‘åœ¨çª—å£1è´­ç¥¨ï¼Œä½ å¯ä»¥åœ¨çª—å£2è´­ç¥¨ï¼Œä½ ä¸éœ€è¦ç­‰æˆ‘ï¼Œæˆ‘ä¹Ÿä¸éœ€è¦ç­‰ä½ ã€‚æ‰€ä»¥å¤šçº¿ç¨‹å¹¶å‘å¯ä»¥æé«˜æ•ˆç‡ã€‚

javaä¸­ä¹‹æ‰€ä»¥æœ‰å¤šçº¿ç¨‹æœºåˆ¶ï¼Œç›®çš„å°±æ˜¯ä¸ºäº† æé«˜ç¨‹åºçš„å¤„ç†æ•ˆç‡ã€‚

### 2.2 ??ä½¿ç”¨äº†å¤šçº¿ç¨‹æœºåˆ¶ä¹‹åï¼Œmainæ–¹æ³•ç»“æŸï¼Œæ˜¯ä¸æ˜¯æœ‰å¯èƒ½ç¨‹åºä¹Ÿä¸ä¼šç»“æŸ??
mainæ–¹æ³•ç»“æŸåªæ˜¯ä¸»çº¿ç¨‹ç»“æŸäº†ï¼Œä¸»æ ˆç©ºäº†ï¼Œå…¶å®ƒçš„æ ˆ(çº¿ç¨‹)å¯èƒ½è¿˜åœ¨å‹æ ˆå¼¹æ ˆã€‚

### 2.3 ??å¯¹äºå•æ ¸çš„CPUæ¥è¯´ï¼ŒçœŸçš„å¯ä»¥åšåˆ°çœŸæ­£çš„å¤šçº¿ç¨‹å¹¶å‘å—??
å¯¹äºå¤šæ ¸çš„CPUç”µè„‘æ¥è¯´ï¼ŒçœŸæ­£çš„å¤šçº¿ç¨‹å¹¶å‘æ˜¯æ²¡é—®é¢˜çš„ã€‚4æ ¸CPUè¡¨ç¤ºåŒä¸€ä¸ªæ—¶é—´ç‚¹ä¸Šï¼Œå¯ä»¥çœŸæ­£çš„æœ‰4ä¸ªè¿›ç¨‹å¹¶å‘æ‰§è¡Œã€‚

å•æ ¸çš„CPUè¡¨ç¤ºåªæœ‰ä¸€ä¸ªå¤§è„‘ï¼š
ä¸èƒ½å¤Ÿåšåˆ°çœŸæ­£çš„å¤šçº¿ç¨‹å¹¶å‘ï¼Œä½†æ˜¯å¯ä»¥åšåˆ°ç»™äººä¸€ç§â€œå¤šçº¿ç¨‹å¹¶å‘â€çš„æ„Ÿè§‰ã€‚

å¯¹äºå•æ ¸çš„CPUæ¥è¯´ï¼Œåœ¨æŸä¸€ä¸ªæ—¶é—´ç‚¹ä¸Šå®é™…ä¸Šåªèƒ½å¤„ç†ä¸€ä»¶äº‹æƒ…ï¼Œä½†æ˜¯ç”±äºCPUçš„å¤„ç†é€Ÿåº¦æå¿«ï¼Œå¤šä¸ªçº¿ç¨‹ä¹‹é—´é¢‘ç¹åˆ‡æ¢æ‰§è¡Œï¼Œç»™åˆ«äººçš„æ„Ÿè§‰æ˜¯ï¼šå¤šä¸ªäº‹æƒ…åŒæ—¶åœ¨åšï¼ï¼ï¼

çº¿ç¨‹Aï¼šæ’­æ”¾éŸ³ä¹

çº¿ç¨‹Bï¼šè¿è¡Œé­”å…½æ¸¸æˆ

çº¿ç¨‹Aå’Œçº¿ç¨‹Bé¢‘ç¹åˆ‡æ¢æ‰§è¡Œï¼Œäººç±»ä¼šæ„Ÿè§‰éŸ³ä¹ä¸€ç›´åœ¨æ’­æ”¾ï¼Œæ¸¸æˆä¸€ç›´åœ¨è¿è¡Œï¼Œ
ç»™æˆ‘ä»¬çš„æ„Ÿè§‰æ˜¯åŒæ—¶å¹¶å‘çš„ã€‚ï¼ˆå› ä¸ºè®¡ç®—æœºçš„é€Ÿåº¦å¾ˆå¿«ï¼Œæˆ‘ä»¬äººçš„çœ¼ç›å¾ˆæ…¢ï¼Œæ‰€ä»¥æ‰ä¼šæ„Ÿè§‰æ˜¯å¤šçº¿ç¨‹ï¼ï¼‰

### 2.4 ??ä»€ä¹ˆæ˜¯çœŸæ­£çš„å¤šçº¿ç¨‹å¹¶å‘??
t1çº¿ç¨‹æ‰§è¡Œt1çš„ã€‚

t2çº¿ç¨‹æ‰§è¡Œt2çš„ã€‚

t1ä¸ä¼šå½±å“t2ï¼Œt2ä¹Ÿä¸ä¼šå½±å“t1ã€‚è¿™å«åšçœŸæ­£çš„å¤šçº¿ç¨‹å¹¶å‘ã€‚

### 3. çº¿ç¨‹çš„å£°æ˜å‘¨æœŸğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

- 1.æ–°å»ºçŠ¶æ€
- 2.å°±ç»ªçŠ¶æ€
- 3.è¿è¡ŒçŠ¶æ€
- 4.é˜»å¡çŠ¶æ€
- 5.æ­»äº¡çŠ¶æ€

![Test](/images/thread01.png)

### 4. java ä¸­å®ç°çº¿ç¨‹çš„ä¸¤ç§æ–¹å¼
#### 4.1 ç¼–å†™ç±» ç»§æ‰¿java.lang.Thread é‡å†™runæ–¹æ³•
MyThreadç±»

``` java
    /**
 * @description:
 * @author:faith
 * @time:2023/6/28 13:28
 */
public class MyThread extends Thread{
    @Override
    public void run(){
        for (int i = 0; i < 1000; i++) {
            System.out.println("åˆ†æ”¯çº¿ç¨‹--->"+i);
        }

    }
}
```
Appç±»
``` java
/**
 * Hello world!
 *
 */
public class App 
{
    public static void main( String[] args )
    {
       MyThread t=new MyThread();
        //ä¸ä¼šå¯åŠ¨çº¿ç¨‹ ä¸ä¼šåˆ†é…æ–°çš„åˆ†æ”¯æ ˆï¼ˆå•çº¿ç¨‹ï¼‰
        t.run();
       // t.start();
       //ä¸»çº¿ç¨‹
        for (int i = 0; i < 1000; i++) {
            System.out.println("ä¸»çº¿ç¨‹---->"+i);
        }
    }
}
```

***<font color=red>æ³¨æ„</font>***
- t.run() åªæ˜¯ä¸ªæ™®é€šæ–¹æ³•çš„è°ƒç”¨ï¼Œ***ä¸ä¼šåˆ†é…æ–°çš„åˆ†æ”¯æ ˆæ˜¯å•çº¿ç¨‹***
- t.start() æ–¹æ³•çš„ä½œç”¨ï¼šå¯åŠ¨ä¸€ä¸ªåˆ†æ”¯çº¿ç¨‹ï¼Œ***å†JVMä¸­å¼€è¾Ÿä¸€ä¸ªæ–°çš„æ ˆç©ºé—´***ï¼Œè¿™æ®µä»£ç ä»»åŠ¡å®Œæˆä¹‹åï¼Œå°±ç»“æŸäº†
è¿™æ®µä»£ç çš„ä»»åŠ¡å°±æ˜¯ä¸ºäº†å¼€å¯ä¸€ä¸ªæ–°çš„æ ˆç©ºé—´ï¼Œåªè¦æ–°çš„æ ˆç©ºé—´å¼€å‡ºæ¥ï¼Œstart()æ–¹æ³•å°±ç»“æŸäº†ã€‚çº¿ç¨‹å°±å¯åŠ¨æˆåŠŸäº†ã€‚å¯åŠ¨æˆåŠŸçš„çº¿ç¨‹å°±ä¼šè‡ªå·±è°ƒç”¨run()æ–¹æ³•ï¼Œå¹¶ä¸”run()æ–¹æ³•çš„åˆ†æ”¯æ ˆçš„æ ˆåº•éƒ¨ï¼ˆå‹æ ˆï¼‰ã€‚run()æ–¹æ³•å†åˆ†æ”¯æ ˆçš„åº•éƒ¨ï¼Œmainæ–¹æ³•å†ä¸»æ ˆçš„æ ˆåº•éƒ¨ã€‚runå’Œmainæ˜¯å¹³çº§çš„ã€‚

#### 4.2 ç¼–å†™ç±»å®ç°java.lang.Runnableæ¥å£ï¼Œå®ç°runæ–¹æ³•

MyRunnableç±»
``` java
/**
 * @description:
 * @author:faith
 * @time:2023/6/28 14:00
 */
// è¿™å¹¶ä¸æ˜¯ä¸€ä¸ªçº¿ç¨‹ç±»ï¼Œæ˜¯ä¸€ä¸ªå¯è¿è¡Œçš„ç±»ã€‚å®ƒè¿˜ä¸æ˜¯ä¸€ä¸ªçº¿ç¨‹
public class MyRunnable implements Runnable{
    @Override
    public void run() {
        for (int i = 0; i < 1000; i++) {
            System.out.println("åˆ†æ”¯çº¿ç¨‹--->"+i);
        }
    }
}
```

Mainç±»
``` java
package com.faith;

/**
 * Hello world!
 *
 */
public class App
{
    public static void main( String[] args )
    {
        Thread t=new Thread(new MyRunnable());
        t.start();

        for (int i = 0; i < 1000; i++) {
            System.out.println("ä¸»çº¿ç¨‹--->"+i);
        }
        //é‡‡ç”¨åŒ¿åå†…éƒ¨ç±»åˆ›å»º
        // Thread t=new Thread(new Runnable() {
        //     @Override
        //     public void run() {
        //         for (int i = 0; i < 1000; i++) {
        //             System.out.println("åˆ†æ”¯çº¿ç¨‹--->"+i);
        //         }
        //     }
        // });
        // t.start();
        // for (int i = 0; i < 1000; i++) {
        //    System.out.println("ä¸»çº¿ç¨‹--->"+i);
        // }
    }
}

```
***<font color=red>æ³¨æ„</font>***

*ä¸€èˆ¬ä½¿ç”¨ç¬¬äºŒç§æ–¹æ³• å› ä¸ºä¸€ä¸ªç±»å®ç°äº†æ¥å£ï¼Œè¿˜å¯ä»¥ç»§æ‰¿å…¶ä»–çš„ç±»ï¼Œç›¸å¯¹æ¥è¯´æ›´åŠ çš„çµæ´»*
#### 4.3ã€è·å–å½“å‰çº¿ç¨‹å¯¹è±¡ã€è·å–çº¿ç¨‹å¯¹è±¡åç§°ã€ä¿®æ”¹çº¿ç¨‹å¯¹è±¡åå­—
|  æ–¹æ³•å   | ä½œç”¨  |
|  :----:  | :----:  |
| static Thread currentThread()  | è·å–å½“å‰çº¿ç¨‹å¯¹è±¡ |
| String getName()  | è·å–çº¿ç¨‹å¯¹è±¡åå­— |
| void setName(String name)  | ä¿®æ”¹çº¿ç¨‹å¯¹è±¡åå­— |

_å½“çº¿ç¨‹æ²¡æœ‰è®¾ç½®åå­—çš„æ—¶å€™ï¼Œé»˜è®¤çš„åå­—æ˜¯ä»€ä¹ˆï¼Ÿ_
- Thread-0
- Thread-1
- Thread-2
- Thread-3
- ...

#### 4.4 å…³äºçº¿ç¨‹çš„sleepæ–¹æ³•
|  æ–¹æ³•å   | ä½œç”¨  |
|  :----:  | :----:  |
| static void sleep(long millis)  | è®©å½“å‰çº¿ç¨‹ä¼‘çœ millisç§’ |

1.é™æ€æ–¹æ³• Thread.sleep(1000)

2.å‚æ•°æ˜¯**æ¯«ç§’**

3.è®©å½“å‰çº¿ç¨‹è¿›å…¥ä¼‘çœ ï¼Œè¿›å…¥â€œé˜»å¡çŠ¶æ€â€ï¼Œæ”¾å¼ƒå æœ‰CPUæ—¶é—´ç‰‡ï¼Œè®©ç»™å…¶å®ƒçº¿ç¨‹ä½¿ç”¨

4.Thread.sleep()æ–¹æ³•ï¼Œå¯ä»¥åšåˆ°è¿™ç§æ•ˆæœï¼š

é—´éš”ç‰¹å®šçš„æ—¶é—´ï¼Œå»æ‰§è¡Œä¸€æ®µç‰¹å®šçš„ä»£ç ï¼Œæ¯éš”å¤šä¹…æ‰§è¡Œä¸€æ¬¡ã€‚

5.ä½¿ç”¨interrupt()æ–¹æ³•ä¸­æ–­ä¼‘çœ 

``` java
    public static void main( String[] args ) {
        Thread thread = new Thread(new Runnable() {
            @Override
            public void run() {
            //ä¼‘çœ ä¸€å¹´
                System.out.println(Thread.currentThread().getName()+"----->begin");
                try {
                    Thread.sleep(1000*60*60*24*365);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
                System.out.println(Thread.currentThread().getName()+"----->end");
            }

        });
        thread.setName("t");
        thread.start();
        //ä¸»çº¿ç¨‹æ²‰ç¡5s
        System.out.println("ä¸»çº¿ç¨‹ä¼‘çœ 5s");
        try {
            Thread.sleep(5000);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
        //ç»ˆæ­¢çº¿ç¨‹ä¼‘çœ 
        thread.interrupt();
    }
```
***<font color=red>ä¸ºä»€ä¹ˆrun()æ–¹æ³•åªèƒ½try..catchä¸èƒ½throwsï¼Ÿ</font>***

å› ä¸ºrun()æ–¹æ³•åœ¨çˆ¶ç±»ä¸­æ²¡æœ‰æŠ›å‡ºä»»ä½•å¼‚å¸¸ï¼Œ**å­ç±»ä¸èƒ½æ¯”çˆ¶ç±»æŠ›å‡ºæ›´å¤šçš„å¼‚å¸¸**ã€‚

#### 4.5 ç»ˆæ­¢çº¿ç¨‹ï¼ˆä¸æ¨èä½¿ç”¨ï¼ï¼ï¼ï¼‰
|  æ–¹æ³•å   | ä½œç”¨  |
|  :----:  | :----:  |
| static void stop()  | ç»ˆæ­¢çº¿ç¨‹ |

è¿™ç§æ–¹å¼å­˜åœ¨å¾ˆå¤§çš„ç¼ºç‚¹ï¼šå®¹æ˜“ä¸¢å¤±æ•°æ®ã€‚

å› ä¸ºè¿™ç§æ–¹å¼æ˜¯ç›´æ¥å°†çº¿ç¨‹æ€æ­»äº†ï¼Œçº¿ç¨‹æ²¡æœ‰ä¿å­˜çš„æ•°æ®å°†ä¼šä¸¢å¤±ã€‚ä¸å»ºè®®ä½¿ç”¨ã€‚
***<font color=red>é‚£ä¹ˆå¦‚ä½•åˆç†çš„ç»ˆæ­¢çº¿ç¨‹å‘¢</font>***

```java
/**
 * Hello world!
 *
 */
public class App
{
    public static void main( String[] args ) {
        MyRunable4 r = new MyRunable4();
        Thread t = new Thread(r);
        t.setName("t");
        t.start();

        // æ¨¡æ‹Ÿ5ç§’
        try {
            Thread.sleep(5000);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
        // ç»ˆæ­¢çº¿ç¨‹
        // ä½ æƒ³è¦ä»€ä¹ˆæ—¶å€™ç»ˆæ­¢tçš„æ‰§è¡Œï¼Œé‚£ä¹ˆä½ æŠŠæ ‡è®°ä¿®æ”¹ä¸ºfalseï¼Œå°±ç»“æŸäº†ã€‚
        r.run = false;

    }

}
class MyRunable4 implements Runnable {

    // æ‰“ä¸€ä¸ªå¸ƒå°”æ ‡è®°
    boolean run = true;

    @Override
    public void run() {
        for (int i = 0; i < 10; i++){
            if(run){
                System.out.println(Thread.currentThread().getName() + "--->" + i);
                try {
                    Thread.sleep(1000);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
            }else{
                // returnå°±ç»“æŸäº†ï¼Œä½ åœ¨ç»“æŸä¹‹å‰è¿˜æœ‰ä»€ä¹ˆæ²¡ä¿å­˜çš„ã€‚
                // åœ¨è¿™é‡Œå¯ä»¥ä¿å­˜å‘€ã€‚
                //save....

                //ç»ˆæ­¢å½“å‰çº¿ç¨‹
                return;
            }
        }
    }
}
```

#### 4.6 è¡¥å……å°çŸ¥è¯†ï¼šçº¿ç¨‹è°ƒåº¦ï¼ˆäº†è§£ï¼‰
1.å¸¸è§çš„çº¿ç¨‹è°ƒåº¦æ¨¡å‹æœ‰å“ªäº›ï¼Ÿ

- æŠ¢å å¼è°ƒåº¦æ¨¡å‹ï¼š

    é‚£ä¸ªçº¿ç¨‹çš„ä¼˜å…ˆçº§æ¯”è¾ƒé«˜ï¼ŒæŠ¢åˆ°çš„CPUæ—¶é—´ç‰‡çš„æ¦‚ç‡å°±é«˜ä¸€äº›/å¤šä¸€äº›ã€‚

    javaé‡‡ç”¨çš„å°±æ˜¯æŠ¢å å¼è°ƒåº¦æ¨¡å‹ã€‚

- å‡åˆ†å¼è°ƒåº¦æ¨¡å‹ï¼š

    å¹³å‡åˆ†é…CPUæ—¶é—´ç‰‡ã€‚æ¯ä¸ªçº¿ç¨‹å æœ‰çš„CPUæ—¶é—´ç‰‡æ—¶é—´é•¿åº¦ä¸€æ ·ã€‚

    å¹³å‡åˆ†é…ï¼Œä¸€åˆ‡å¹³ç­‰ã€‚

    æœ‰ä¸€äº›ç¼–ç¨‹è¯­è¨€ï¼Œçº¿ç¨‹è°ƒåº¦æ¨¡å‹é‡‡ç”¨çš„æ˜¯è¿™ç§æ–¹å¼ã€‚

#### 4.7 javaä¸­æä¾›äº†å“ªäº›æ–¹æ³•æ˜¯å’Œçº¿ç¨‹è°ƒåº¦æœ‰å…³ç³»çš„å‘¢ï¼Ÿ
##### 4.7.1 å®ä¾‹æ–¹æ³•
|  æ–¹æ³•å   | ä½œç”¨  |
|  :----:  | :----:  |
| int getPriority()  | è·å¾—çº¿ç¨‹ä¼˜å…ˆçº§ |
| void setPriority(int newPriority)  | è®¾ç½®çº¿ç¨‹ä¼˜å…ˆçº§ |

- æœ€ä½ä¼˜å…ˆçº§1
- é»˜è®¤ä¼˜å…ˆçº§æ˜¯5
- æœ€é«˜ä¼˜å…ˆçº§10

ä¼˜å…ˆçº§æ¯”è¾ƒé«˜çš„è·å–CPUæ—¶é—´ç‰‡å¯èƒ½ä¼šå¤šä¸€äº›ã€‚ï¼ˆä½†ä¹Ÿä¸å®Œå…¨æ˜¯ï¼Œå¤§æ¦‚ç‡æ˜¯å¤šçš„ã€‚ï¼‰

##### 4.7.2 é™æ€æ–¹æ³•
|  æ–¹æ³•å   | ä½œç”¨  |
|  :----:  | :----:  |
| static void yield()  | è®©ä½æ–¹æ³•ï¼Œå½“å‰çº¿ç¨‹æš‚åœï¼Œå›åˆ°å°±ç»ªçŠ¶æ€ï¼Œè®©ç»™å…¶å®ƒçº¿ç¨‹ã€‚ |

yield()æ–¹æ³•ä¸æ˜¯é˜»å¡æ–¹æ³•ã€‚è®©å½“å‰çº¿ç¨‹è®©ä½ï¼Œè®©ç»™å…¶å®ƒçº¿ç¨‹ä½¿ç”¨ã€‚

yield()æ–¹æ³•çš„æ‰§è¡Œä¼šè®©å½“å‰çº¿ç¨‹ä»â€œè¿è¡ŒçŠ¶æ€â€å›åˆ°â€œå°±ç»ªçŠ¶æ€â€ã€‚

***<font color=red>æ³¨æ„ï¼šåœ¨å›åˆ°å°±ç»ªä¹‹åï¼Œæœ‰å¯èƒ½è¿˜ä¼šå†æ¬¡æŠ¢åˆ°ã€‚</font>***

##### 4.7.2 å®ä¾‹æ–¹æ³•
|  æ–¹æ³•å   | ä½œç”¨  |
|  :----:  | :----:  |
| void join()  | å°†ä¸€ä¸ªçº¿ç¨‹åˆå¹¶åˆ°å½“å‰çº¿ç¨‹ä¸­ï¼Œå½“å‰çº¿ç¨‹å—é˜»å¡ï¼ŒåŠ å…¥çš„çº¿ç¨‹æ‰§è¡Œç›´åˆ°ç»“æŸ |
| void join(long millis)  | æ¥ä¸Šæ¡ï¼Œç­‰å¾…è¯¥çº¿ç¨‹ç»ˆæ­¢çš„æ—¶é—´æœ€é•¿ä¸º millis æ¯«ç§’ |
| void join(long millis, int nanos)  | æ¥ç¬¬ä¸€æ¡ï¼Œç­‰å¾…è¯¥çº¿ç¨‹ç»ˆæ­¢çš„æ—¶é—´æœ€é•¿ä¸º millis æ¯«ç§’ + nanos çº³ç§’ |

``` java
class MyThread1 extends Thread {
	public void doSome(){
		MyThread2 t = new MyThread2();
		t.join(); // å½“å‰çº¿ç¨‹è¿›å…¥é˜»å¡ï¼Œtçº¿ç¨‹æ‰§è¡Œï¼Œç›´åˆ°tçº¿ç¨‹ç»“æŸã€‚å½“å‰çº¿ç¨‹æ‰å¯ä»¥ç»§ç»­ã€‚
	}
}

class MyThread2 extends Thread{

}
```

#### 5.å¤šçº¿ç¨‹å¹¶å‘æƒ…å†µä¸‹ æ•°æ®çš„é‡è¦æ€§

**ä»€ä¹ˆæ—¶å€™æ•°æ®åœ¨å¤šçº¿ç¨‹å¹¶å‘çš„ç¯å¢ƒä¸‹ä¼šå­˜åœ¨å®‰å…¨é—®é¢˜å‘¢**ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
æ»¡è¶³ä¸‰ä¸ªæ¡ä»¶ï¼š

- æ¡ä»¶1ï¼šå¤šçº¿ç¨‹å¹¶å‘ã€‚
- æ¡ä»¶2ï¼šæœ‰å…±äº«æ•°æ®ã€‚
- æ¡ä»¶3ï¼šå…±äº«æ•°æ®æœ‰ä¿®æ”¹çš„è¡Œä¸ºã€‚

æ»¡è¶³ä»¥ä¸Š3ä¸ªæ¡ä»¶ä¹‹åï¼Œå°±ä¼šå­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚

**æ€ä¹ˆè§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜å‘¢ï¼Ÿ**
åŒæ­¥ç­–ç•¥ å°±æ˜¯ä¸€ä¸ªçº¿ç¨‹ä¸€ä¸ªçº¿ç¨‹æ’é˜Ÿä¸èƒ½å¹¶å‘ ä½†æ˜¯æ•ˆç‡ä¼šé™ä½
å¼‚æ­¥ç­–ç•¥ æ¯ä¸ªçº¿ç¨‹ä¾æ¬¡åšè‡ªå·±çš„äº‹æƒ… æ•ˆç‡é«˜
#### 6. çº¿ç¨‹å®‰å…¨
##### 6.1ä½¿ç”¨synchronizedé”å¯¹è±¡

``` java
synchronized(é”å¯¹è±¡){

}
```
å½“ä¸€ä¸ªçº¿ç¨‹å ç”¨ç€å…¬å…±èµ„æºçš„æ—¶å€™ä¼šä¸Šé” å…¶ä»–çº¿ç¨‹å°±éœ€è¦ç­‰å¾…å‰é¢çš„çº¿ç¨‹ç»“æŸæ‰èƒ½å†è¿›å»
é”å¯¹è±¡å¿…é¡»æ˜¯å”¯ä¸€çš„ å¯ä»¥ä½¿ç”¨ static Object obj = new Object()
å¿…é¡»åŠ ä¸Šstaticå…³é”®å­—æ ‡æ³¨æ˜¯é™æ€ è¿™æ ·è¿™ä¸ªå¯¹è±¡å°±æ˜¯å”¯ä¸€çš„äº†

æ¡ˆä¾‹

``` java
public class App
{
    public static void main( String[] args ) {
          Thread t1 = new Thread(new ThreadTest());
          Thread t2 = new Thread(new ThreadTest());
          Thread t3 = new Thread(new ThreadTest());

          t1.setName("çª—å£1");
          t2.setName("çª—å£2");
          t3.setName("çª—å£3");

          t1.start();
          t2.start();
          t3.start();
    }
}
class ThreadTest implements Runnable{
   private static Object obj=new Object();
    static int ticket = 0;
    @Override
    public void run() {
     while (true){
         synchronized (obj){
             if (ticket<100){
                 try {
                     Thread.sleep(100);
                 } catch (InterruptedException e) {
                     e.printStackTrace();
                 }
                 ticket++;
                 System.out.println(Thread.currentThread().getName()+"æ­£åœ¨å–ç¬¬"+ticket+"ç¥¨");
             }else {
                 break;
             }
         }

     }
    }
}
```
##### 6.2ä½¿ç”¨synchronizedé”æ–¹æ³•
åŒæ­¥æ–¹æ³•

å°±æ˜¯æŠŠsynchronizedå…³é”®å­—åŠ åˆ°æ–¹æ³•ä¸Š

æ ¼å¼
>ä¿®é¥°ç¬¦ synchronized è¿”å›å€¼ç±»å‹(æ–¹æ³•å‚æ•°){...}
``` java
/**
 * Hello world!
 *
 */
public class App
{
    public static void main( String[] args ) {
          ThreadTest threadTest = new ThreadTest();
          Thread t1 = new Thread(threadTest);
          Thread t2 = new Thread(threadTest);
          Thread t3 = new Thread(threadTest);

          t1.setName("çª—å£1");
          t2.setName("çª—å£2");
          t3.setName("çª—å£3");

          t1.start();
          t2.start();
          t3.start();
    }
}
class ThreadTest implements Runnable{
    int ticket = 0;
    @Override
    public void run() {
     while (true){
         if (extracted()) break;

     }
    }
    //å½“åŒæ­¥æ–¹æ³•æ˜¯åŠ åœ¨éé™æ€çš„æ–¹æ³•ä¸Šçš„é‚£ä¹ˆè¿™ä¸ªæ—¶å€™è‡ªåŠ¨é”çš„å°±æ˜¯this
    //å¦‚æœåŒæ­¥æ–¹æ³•æ˜¯åŠ åœ¨é™æ€æ–¹æ³•ä¸Šçš„é‚£ä¹ˆé”çš„å¯¹è±¡å°±æ˜¯è¿™ä¸ªç±»çš„å­—èŠ‚ç æ–‡ä»¶å¯¹è±¡
    private synchronized boolean extracted() {
        if (ticket<100){
            try {
                Thread.sleep(100);
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
            ticket++;
            System.out.println(Thread.currentThread().getName()+"æ­£åœ¨å–ç¬¬"+ticket+"ç¥¨");
        }else {
            return true;
        }
        return false;
    }
}
```

***<font color=red>æ³¨æ„äº‹é¡¹</font>***

>åœ¨å¯¹äºstringbuilder å’Œ stringbufferä¸Š ä»æºç å¯ä»¥çœ‹å‡ºstringbufferçš„æ–¹æ³•ä¸Šéƒ½åŠ äº†synchronizedï¼Œæ‰€ä»¥tringbufferæ˜¯çº¿ç¨‹å®‰å…¨çš„ stringbuilderæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ å•çº¿ç¨‹ä¸­ä½¿ç”¨stringbuilderæ•ˆç‡æ›´é«˜ï¼Œå¤šçº¿ç¨‹ä½¿ç”¨stringbufferæ›´å®‰å…¨

##### 6.3 locké”
è™½ç„¶æˆ‘ä»¬å¯ä»¥ç†è§£åŒæ­¥ä»£ç å’ŒåŒæ­¥æ–¹æ³•çš„é”å¯¹è±¡é—®é¢˜ï¼Œä½†æ˜¯æˆ‘ä»¬å¹¶æ²¡æœ‰ç›´æ¥çœ‹åˆ°åœ¨å“ªé‡ŒåŠ ä¸Šäº†é”ï¼Œåœ¨å“ªé‡Œé‡Šæ”¾äº†é”ï¼Œä¸ºäº†æ›´æ¸…æ™°çš„è¡¨è¾¾å¦‚ä½•åŠ é”å’Œé‡Šæ”¾é”ï¼Œjdkä»¥åæä¾›äº†ä¸€ä¸ªæ–°çš„é”å¯¹è±¡Lock

Lockå®ç°æä¾›æ¯”ä½¿ç”¨synchronizedæ–¹æ³•å’Œè¯­å¥å¯ä»¥è·å¾—æ›´å¹¿æ³›çš„é”å®šæ“ä½œ,Lockä¸­æä¾›äº†è·å¾—é”å’Œé‡Šæ”¾é”çš„æ–¹æ³•

void lock();//è·å¾—é”

void unlock();//é‡Šæ”¾é”

Lockæ˜¯ä¸èƒ½ç›´æ¥å®ä¾‹åŒ–ï¼Œè¿™é‡Œé‡‡ç”¨å®ƒçš„å®ç°ç±»ReentrantLockæ¥å®ä¾‹åŒ–

ReentrantLockçš„æ„é€ å‡½æ•°

ReentrantLock();åˆ›å»ºä¸€ä¸ªReentrantLockçš„å®ä¾‹

é‡Šæ”¾é”æ”¾åœ¨finally æœ€å®‰å…¨

æ¡ˆä¾‹

``` java
/**
 * Hello world!
 *
 */
public class App
{
    public static void main( String[] args ) {
          ThreadTest threadTest = new ThreadTest();
          Thread t1 = new Thread(threadTest);
          Thread t2 = new Thread(threadTest);
          Thread t3 = new Thread(threadTest);

          t1.setName("çª—å£1");
          t2.setName("çª—å£2");
          t3.setName("çª—å£3");

          t1.start();
          t2.start();
          t3.start();
    }
}
class ThreadTest implements Runnable{
    int ticket = 0;
    Lock lock = new ReentrantLock();
    @Override
    public void run() {
     while (true){
         if (extracted()) break;

     }
    }

    private boolean extracted() {

        try {
            lock.lock();
            if (ticket<100){
                   Thread.sleep(100);
                ticket++;
                System.out.println(Thread.currentThread().getName()+"æ­£åœ¨å–ç¬¬"+ticket+"ç¥¨");
            }else {
                return true;
            }
        } catch (InterruptedException e) {
            throw new RuntimeException(e);
        } finally {
            lock.unlock();
        }
        return false;
    }
}
```
##### 6.3 æ­»é”
å¯ä»¥ç†è§£ä¸ºä¸¤ä¸ªçº¿ç¨‹éƒ½åœ¨äº’ç›¸ç­‰å¾…å¯¹æ–¹é‡Šæ”¾é” å¯¼è‡´ç¨‹åºæ­»é”ã€‚

##### 6.4 2023/08/10 è¡¥å……  å®ˆæŠ¤çº¿ç¨‹
æ¯”å¦‚å†java mainæ–¹æ³•ä¸­å†™ä¸€ä¸ªæ­»å¾ªç¯çš„çº¿ç¨‹
``` java
    public static void main(String[] args) {
        System.out.println("å½“å‰çº¿ç¨‹"+Thread.currentThread().getName());
       Thread t = new Thread(()->{
        while (true){
            try {
                Thread.sleep(2000);
                System.out.println("å­çº¿ç¨‹æ­£åœ¨æ‰§è¡Œ"+Thread.currentThread().getName());
            } catch (InterruptedException e) {
                throw new RuntimeException(e);
            }
        }
       });
       t.start();
        System.out.println("å½“å‰çº¿ç¨‹ç»“æŸ"+Thread.currentThread().getName());
    }
```
æ‰§è¡Œç»“æœ
``` bash
å½“å‰çº¿ç¨‹main
å½“å‰çº¿ç¨‹ç»“æŸmain
å­çº¿ç¨‹æ­£åœ¨æ‰§è¡ŒThread-0
å­çº¿ç¨‹æ­£åœ¨æ‰§è¡ŒThread-0
å­çº¿ç¨‹æ­£åœ¨æ‰§è¡ŒThread-0
```
å¦‚ä¸Šé¢æ‰€è¯´çš„ ä¸»çº¿ç¨‹ç»“æŸäº† jvmä¹Ÿä¸ä¼šé€€å‡º å› ä¸ºæœ‰ä¸ªå­çº¿ç¨‹è¿˜æ²¡æœ‰ç»“æŸ å¹¶ä¸”æ²¡æœ‰å¼‚å¸¸çš„è¯ è¿™ä¸ªçº¿ç¨‹ä¼šä¸€åªæ‰§è¡Œä¸‹å»
é‚£ä¹ˆè¿™æ—¶å€™å‡å¦‚æˆ‘ä»¬æƒ³ä¸»çº¿ç¨‹ç»“æŸ è¿™ä¸ªå­çº¿ç¨‹ä¹Ÿè·Ÿç€ä¸€å—ç»“æŸå‘¢ï¼Ÿï¼Ÿ
é‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±è¦ä½¿ç”¨åˆ°å®ˆæŠ¤çº¿ç¨‹äº†æˆ‘ä»¬æ¥ä¿®æ”¹ä¸€ä¸‹ä»£ç 
``` java
    public static void main(String[] args) throws InterruptedException {
        System.out.println("å½“å‰çº¿ç¨‹"+Thread.currentThread().getName());
        Thread t = new Thread(()->{
        while (true){
            try {
                Thread.sleep(2000);
                System.out.println("å­çº¿ç¨‹æ­£åœ¨æ‰§è¡Œ"+Thread.currentThread().getName());
            } catch (InterruptedException e) {
                throw new RuntimeException(e);
            }
        }
       });
       //è®¾ç½®tçº¿ç¨‹ä¸ºå®ˆæŠ¤çº¿ç¨‹
        t.setDaemon(true);
        t.start();
        
       //ä¸»çº¿ç¨‹ä¼‘çœ 6s
        Thread.sleep(6000);
        System.out.println("å½“å‰çº¿ç¨‹ç»“æŸ"+Thread.currentThread().getName());
    }
```

æŸ¥çœ‹è¾“å‡ºç»“æœ

``` bash
å½“å‰çº¿ç¨‹main
å­çº¿ç¨‹æ­£åœ¨æ‰§è¡ŒThread-0
å­çº¿ç¨‹æ­£åœ¨æ‰§è¡ŒThread-0
å½“å‰çº¿ç¨‹ç»“æŸmain
Process finished with exit code 0
```
å¯ä»¥çœ‹å‡ºä¸»çº¿ç¨‹ç»“æŸäº† jvmä¹Ÿè·Ÿç€ç»“æŸäº† å­çº¿ç¨‹ä¹Ÿè·Ÿç€ä¸€èµ·ç»“æŸäº†ã€‚

åœ¨å®ˆæŠ¤çº¿ç¨‹ä¸­ï¼Œç¼–å†™ä»£ç è¦æ³¨æ„ï¼šå®ˆæŠ¤çº¿ç¨‹ä¸èƒ½æŒæœ‰ä»»ä½•éœ€è¦å…³é—­çš„èµ„æºï¼Œä¾‹å¦‚æ‰“å¼€æ–‡ä»¶ç­‰ï¼Œå› ä¸ºè™šæ‹Ÿæœºé€€å‡ºæ—¶ï¼Œå®ˆæŠ¤çº¿ç¨‹æ²¡æœ‰ä»»ä½•æœºä¼šæ¥å…³é—­æ–‡ä»¶ï¼Œè¿™ä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±ã€‚

å®ˆæŠ¤çº¿ç¨‹æ˜¯ä¸ºå…¶ä»–çº¿ç¨‹æœåŠ¡çš„çº¿ç¨‹ï¼›

æ‰€æœ‰éå®ˆæŠ¤çº¿ç¨‹éƒ½æ‰§è¡Œå®Œæ¯•åï¼Œè™šæ‹Ÿæœºé€€å‡ºï¼›

##### ä½¿ç”¨çº¿ç¨‹æ± 
java è¯­è¨€è™½ç„¶å†…ç½®äº†å¤šçº¿ç¨‹æ”¯æŒï¼Œå¯åŠ¨ä¸€ä¸ªçº¿ç¨‹ä¹Ÿå¾ˆæ–¹ä¾¿ï¼Œä½†æ˜¯åˆ›å»ºä¸€ä¸ªçº¿ç¨‹éœ€è¦æ“ä½œç³»ç»Ÿé¢‘ç¹çš„æ“ä½œç³»ç»Ÿèµ„æºï¼Œéœ€è¦æ¶ˆè€—å¤§é‡çš„æ—¶é—´
æˆ‘ä»¬å¯ä»¥æŠŠå¾ˆå¤šå°ä»»åŠ¡è®©ä¸€ç»„çº¿ç¨‹æ¥æ‰§è¡Œï¼Œè€Œä¸æ˜¯ä¸€ä¸ªäººä»»åŠ¡å¯¹åº”ä¸€ä¸ªçº¿ç¨‹ã€‚è¿™ç§èƒ½æ¥å—å¤§é‡å°ä»»åŠ¡å¹¶è¿›è¡Œåˆ†å‘å¤„ç†çš„å°±æ˜¯çº¿ç¨‹æ± ã€‚ç®€å•çš„è¯´ï¼Œçº¿ç¨‹æ± é‡Œé¢ç»´æŠ¤äº†è‹¥å¹²ä¸ªçº¿ç¨‹ï¼Œæ²¡æœ‰ä»»åŠ¡çš„æ—¶å€™å°±å¤„äºç­‰å¾…çŠ¶æ€ï¼Œå¦‚æœæœ‰æ–°ä»»åŠ¡çš„è¯å°±åˆ†é…ä¸€ä¸ªç©ºé—²çš„çº¿ç¨‹å»å·¥ä½œï¼Œå¦‚æœæ‰€æœ‰çº¿ç¨‹éƒ½å¤„äºç¹å¿™çš„çŠ¶æ€ï¼Œæ–°ä»»åŠ¡è¦ä¹ˆæ”¾åœ¨é˜Ÿåˆ—ä¸­ç­‰å¾…ï¼Œè¦ä¹ˆå¢åŠ ä¸€ä¸ªæ–°çº¿ç¨‹è¿›è¡Œå¤„ç†ã€‚